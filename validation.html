<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Validation | Simulating the Truncated Triangular Distribution</title>
  <meta name="description" content="This documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Validation | Simulating the Truncated Triangular Distribution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  <meta name="github-repo" content="MantiMantilla/Truncated-Triangular-Simulation-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Validation | Simulating the Truncated Triangular Distribution" />
  
  <meta name="twitter:description" content="This documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  

<meta name="author" content="Alejandro Mantilla, Data Scientist and Engineer" />


<meta name="date" content="2021-02-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#your-own-flare"><i class="fa fa-check"></i><b>1.2</b> Your own flare</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#project-home"><i class="fa fa-check"></i><b>1.3</b> Project home</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#license-author-and-acknowledgements"><i class="fa fa-check"></i><b>1.4</b> License, Author, and Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="triangular-distribution.html"><a href="triangular-distribution.html"><i class="fa fa-check"></i><b>2</b> Triangular Distribution</a><ul>
<li class="chapter" data-level="2.1" data-path="triangular-distribution.html"><a href="triangular-distribution.html#distributions"><i class="fa fa-check"></i><b>2.1</b> Distributions</a></li>
<li class="chapter" data-level="2.2" data-path="triangular-distribution.html"><a href="triangular-distribution.html#triangular-pdf"><i class="fa fa-check"></i><b>2.2</b> Triangular PDF</a></li>
<li class="chapter" data-level="2.3" data-path="triangular-distribution.html"><a href="triangular-distribution.html#triangular-cdf"><i class="fa fa-check"></i><b>2.3</b> Triangular CDF</a></li>
<li class="chapter" data-level="2.4" data-path="triangular-distribution.html"><a href="triangular-distribution.html#inverse-triangular-cdf"><i class="fa fa-check"></i><b>2.4</b> Inverse Triangular CDF</a></li>
<li class="chapter" data-level="2.5" data-path="triangular-distribution.html"><a href="triangular-distribution.html#measures-of-central-tendency-and-spread"><i class="fa fa-check"></i><b>2.5</b> Measures of Central Tendency and Spread</a><ul>
<li class="chapter" data-level="2.5.1" data-path="triangular-distribution.html"><a href="triangular-distribution.html#mean"><i class="fa fa-check"></i><b>2.5.1</b> Mean</a></li>
<li class="chapter" data-level="2.5.2" data-path="triangular-distribution.html"><a href="triangular-distribution.html#median"><i class="fa fa-check"></i><b>2.5.2</b> Median</a></li>
<li class="chapter" data-level="2.5.3" data-path="triangular-distribution.html"><a href="triangular-distribution.html#mode"><i class="fa fa-check"></i><b>2.5.3</b> Mode</a></li>
<li class="chapter" data-level="2.5.4" data-path="triangular-distribution.html"><a href="triangular-distribution.html#variance"><i class="fa fa-check"></i><b>2.5.4</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="triangular-distribution.html"><a href="triangular-distribution.html#an-object-to-hold-these-properties"><i class="fa fa-check"></i><b>2.6</b> An Object to Hold These Properties</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html"><i class="fa fa-check"></i><b>3</b> Truncated Triangular Distribution</a><ul>
<li class="chapter" data-level="3.1" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-distribution"><i class="fa fa-check"></i><b>3.1</b> Truncated Distribution</a></li>
<li class="chapter" data-level="3.2" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-triangular-pdf"><i class="fa fa-check"></i><b>3.2</b> Truncated Triangular PDF</a></li>
<li class="chapter" data-level="3.3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-triangular-cdf"><i class="fa fa-check"></i><b>3.3</b> Truncated Triangular CDF</a></li>
<li class="chapter" data-level="3.4" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#inverse-truncated-triangular-cdf"><i class="fa fa-check"></i><b>3.4</b> Inverse Truncated Triangular CDF</a></li>
<li class="chapter" data-level="3.5" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#measures-of-central-tendency-and-spread-1"><i class="fa fa-check"></i><b>3.5</b> Measures of Central Tendency and Spread</a><ul>
<li class="chapter" data-level="3.5.1" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#mean-1"><i class="fa fa-check"></i><b>3.5.1</b> Mean</a></li>
<li class="chapter" data-level="3.5.2" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#median-1"><i class="fa fa-check"></i><b>3.5.2</b> Median</a></li>
<li class="chapter" data-level="3.5.3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#mode-1"><i class="fa fa-check"></i><b>3.5.3</b> Mode</a></li>
<li class="chapter" data-level="3.5.4" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#variance-1"><i class="fa fa-check"></i><b>3.5.4</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#an-object-to-hold-these-properties-1"><i class="fa fa-check"></i><b>3.6</b> An Object to Hold These Properties</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>4</b> Simulation</a><ul>
<li class="chapter" data-level="4.1" data-path="simulation.html"><a href="simulation.html#uniform-distribution"><i class="fa fa-check"></i><b>4.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="4.2" data-path="simulation.html"><a href="simulation.html#pseudo-random-uniform-numbers"><i class="fa fa-check"></i><b>4.2</b> Pseudo-random Uniform Numbers</a></li>
<li class="chapter" data-level="4.3" data-path="simulation.html"><a href="simulation.html#pseudo-random-variables"><i class="fa fa-check"></i><b>4.3</b> Pseudo-Random Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="simulation.html"><a href="simulation.html#inverse-cdf-method"><i class="fa fa-check"></i><b>4.3.1</b> Inverse CDF Method</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulation.html"><a href="simulation.html#trial-and-error"><i class="fa fa-check"></i><b>4.3.2</b> Trial and Error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>5</b> Validation</a><ul>
<li class="chapter" data-level="5.1" data-path="validation.html"><a href="validation.html#hypothesis-test-for-variance"><i class="fa fa-check"></i><b>5.1</b> Hypothesis test for Variance</a></li>
<li class="chapter" data-level="5.2" data-path="validation.html"><a href="validation.html#hypothesis-test-for-mean"><i class="fa fa-check"></i><b>5.2</b> Hypothesis test for mean</a></li>
<li class="chapter" data-level="5.3" data-path="validation.html"><a href="validation.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>5.3</b> Goodness of Fit Tests</a><ul>
<li class="chapter" data-level="5.3.1" data-path="validation.html"><a href="validation.html#chi-square-test"><i class="fa fa-check"></i><b>5.3.1</b> Chi-Square Test</a></li>
<li class="chapter" data-level="5.3.2" data-path="validation.html"><a href="validation.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>5.3.2</b> Kolmogorov-Smirnov Test</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="validation.html"><a href="validation.html#further-analysis"><i class="fa fa-check"></i><b>5.4</b> Further Analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulating the Truncated Triangular Distribution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="validation" class="section level1">
<h1><span class="header-section-number">5</span> Validation</h1>
<p>To validate our claims that both vectors create samples that match the truncated triangular distribution, a few hypothesis tests are in order.</p>
<p>First, we validate that the sample variance and the distribution variance match; second, we evaluate whether their mean statistics match. If both these tests are passed, we perform a goodness of fit test. Specifically, a <em>Kolmogorov-Smirnof</em> test or a <em>Chi-Square test</em>.</p>
<p>These tests rely on a significance level (<span class="math inline">\(\alpha\)</span>) which we have appropriately picked to be 0.1. The grater the significance level, the more certain you are that your results are not a product of chance and the true behavior of your random variable.</p>
<p>Usually when using the more common procedures for testing hypothesis, our data needs to meet a few criteria.</p>
<div id="hypothesis-test-for-variance" class="section level2">
<h2><span class="header-section-number">5.1</span> Hypothesis test for Variance</h2>
<p>Specifically, when testing for variance equivalence using a Chi-Square (<span class="math inline">\(\chi^{2}\)</span>) test, we should validate that the sample variance follows a <span class="math inline">\(\chi^{2}\)</span> distribution.</p>
<p>This usually isn’t the case but to the detriment that we introduce some uncertainty, the condition can be assumed if the distribution of the data roughly ressembles a normal distribution and the sample size is big enough (our sample size is 10000, no need to worry there).</p>
<p>If we didn’t know that our data follows a triangular distribution this could be a fairly save assumption, but because that really isn’t the case, more advanced techniques like bootstraping should be used while performing this test. Such is left as an excercise to the reader.</p>
<p>Let’s study the mathematical procedure.</p>
<p>Since we want to validate that the variance of the sample is the same as that of the distribution (some value <span class="math inline">\(\sigma^{2}\)</span>), we make opposing statements about it. We call these statements our <em>null hypothesis</em> and our <em>alternate hypothesis</em>. In the end, we should be able to say, for some certainty, whether or not we may reject the <em>null hypothesis</em>.</p>
<p><span class="math display">\[
  H_{0}:\hat{\sigma} ^{2} = \sigma^{2}
\]</span></p>
<p><span class="math display">\[
  H_{a}:\hat{\sigma}^{2} \neq \sigma^{2}
\]</span></p>
<p>We then calculate the sample variance:</p>
<p><span class="math display">\[
  S^{2}=\sum_{i=1}^{n}\frac{(x_{i}-\bar{X})^{2}}{n-1}
\]</span></p>
<p>and plug it into the test statistic:</p>
<p><span class="math display">\[
  \left(\frac{S}{\sigma}\right)^{2}(n-1)\sim\chi^{2}_{n-1}.
\]</span></p>
<p>The <em>alternate hypothesis</em> tells us that this is a two-tailed test, meaning we must use both ends of the <span class="math inline">\(\chi^{2}\)</span> distribution. We reject <span class="math inline">\(H_{0}\)</span> if the test statistic falls outside the interval bounded by the <span class="math inline">\(\chi^{2}\)</span> inverse CDF evaluated at <span class="math inline">\(1-\frac{\alpha}{2}\)</span> and at <span class="math inline">\(\frac{\alpha}{2}\)</span> with <span class="math inline">\(n-1\)</span> degrees of freedom. This may seem unorthodox, but the most common notation used to reference these bounds is <span class="math inline">\(\chi^{2}_{1-\frac{\alpha}{2},n-1}\)</span> and <span class="math inline">\(\chi^{2}_{\frac{\alpha}{2},n-1}\)</span>.</p>
<p><span class="math display">\[
  \chi^{2}_{\frac{\alpha}{2},n-1}\leq\left(\frac{S}{\sigma}\right)^{2}(n-1)\leq \chi^{2}_{1-\frac{\alpha}{2},n-1} \Rightarrow \hat{\sigma}^{2}=\sigma^{2}
\]</span></p>
<p>We shall now implement this in R. Do consider, there is no exact method to calculate the inverse CDF of the <span class="math inline">\(\chi^{2}\)</span> distribution that we could reasonably implement such as a closed form expression, and so we must use R’s native function to find approximate values. Most mathematical software come with their own implementation of this method or have third party libraries to extend their functionality (such as SciPy for Python).</p>
<p>Do remember that we have stored the simulated data for each method in their respective variables: <code>simulated.Z.prime.Inv.CDF</code> and <code>simulated.Z.prime.t.and.e</code>, and the truncated triangular distribution object in the variable <code>my.trun.tri.dist</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="validation.html#cb21-1"></a><span class="co">## Inverse CDF method</span></span>
<span id="cb21-2"><a href="validation.html#cb21-2"></a></span>
<span id="cb21-3"><a href="validation.html#cb21-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb21-4"><a href="validation.html#cb21-4"></a>degrees.of.freedom &lt;-<span class="st"> </span>(<span class="kw">length</span>(simulated.Z.prime.Inv.CDF) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb21-5"><a href="validation.html#cb21-5"></a></span>
<span id="cb21-6"><a href="validation.html#cb21-6"></a><span class="co">## 1. Sample Variance and true variance</span></span>
<span id="cb21-7"><a href="validation.html#cb21-7"></a>s.squared.Inv.CDF &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">mean</span>(simulated.Z.prime.Inv.CDF) <span class="op">-</span><span class="st"> </span>simulated.Z.prime.Inv.CDF) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>degrees.of.freedom</span>
<span id="cb21-8"><a href="validation.html#cb21-8"></a></span>
<span id="cb21-9"><a href="validation.html#cb21-9"></a>sigma.squared &lt;-<span class="st"> </span>my.trun.tri.dist<span class="op">$</span>trun.tri.var</span>
<span id="cb21-10"><a href="validation.html#cb21-10"></a></span>
<span id="cb21-11"><a href="validation.html#cb21-11"></a><span class="co">## 2. Test Statistic</span></span>
<span id="cb21-12"><a href="validation.html#cb21-12"></a>test.statistic &lt;-<span class="st"> </span>s.squared.Inv.CDF <span class="op">*</span><span class="st"> </span>degrees.of.freedom <span class="op">/</span><span class="st"> </span>sigma.squared</span>
<span id="cb21-13"><a href="validation.html#cb21-13"></a></span>
<span id="cb21-14"><a href="validation.html#cb21-14"></a><span class="co">## 3. Evaluate if statistic falls within bounds</span></span>
<span id="cb21-15"><a href="validation.html#cb21-15"></a>lower.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb21-16"><a href="validation.html#cb21-16"></a>upper.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&lt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb21-17"><a href="validation.html#cb21-17"></a></span>
<span id="cb21-18"><a href="validation.html#cb21-18"></a><span class="co">## 4. Conclude:</span></span>
<span id="cb21-19"><a href="validation.html#cb21-19"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb21-20"><a href="validation.html#cb21-20"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb21-21"><a href="validation.html#cb21-21"></a>  <span class="cf">if</span> (lower.bound.criteria <span class="op">&amp;</span><span class="st"> </span>upper.bound.criteria) {</span>
<span id="cb21-22"><a href="validation.html#cb21-22"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb21-23"><a href="validation.html#cb21-23"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-24"><a href="validation.html#cb21-24"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb21-25"><a href="validation.html#cb21-25"></a>  },</span>
<span id="cb21-26"><a href="validation.html#cb21-26"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<p>Effectively, via the inverse CDF method we generate a sample with the same variance as the underlying truncated triangular distribution.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="validation.html#cb23-1"></a><span class="co">## Trial and Error</span></span>
<span id="cb23-2"><a href="validation.html#cb23-2"></a></span>
<span id="cb23-3"><a href="validation.html#cb23-3"></a>degrees.of.freedom &lt;-<span class="st"> </span>(<span class="kw">length</span>(simulated.Z.prime.t.and.e) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb23-4"><a href="validation.html#cb23-4"></a></span>
<span id="cb23-5"><a href="validation.html#cb23-5"></a><span class="co">## 1. Sample Variance</span></span>
<span id="cb23-6"><a href="validation.html#cb23-6"></a>s.squared.t.and.e &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">mean</span>(simulated.Z.prime.t.and.e) <span class="op">-</span><span class="st"> </span>simulated.Z.prime.t.and.e) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>degrees.of.freedom</span>
<span id="cb23-7"><a href="validation.html#cb23-7"></a></span>
<span id="cb23-8"><a href="validation.html#cb23-8"></a><span class="co">## 2. Test Statistic</span></span>
<span id="cb23-9"><a href="validation.html#cb23-9"></a>test.statistic &lt;-<span class="st"> </span>s.squared.t.and.e <span class="op">*</span><span class="st"> </span>degrees.of.freedom <span class="op">/</span><span class="st"> </span>sigma.squared</span>
<span id="cb23-10"><a href="validation.html#cb23-10"></a></span>
<span id="cb23-11"><a href="validation.html#cb23-11"></a><span class="co">## 3. Evaluate if statistic falls within bounds</span></span>
<span id="cb23-12"><a href="validation.html#cb23-12"></a>lower.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb23-13"><a href="validation.html#cb23-13"></a>upper.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&lt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb23-14"><a href="validation.html#cb23-14"></a></span>
<span id="cb23-15"><a href="validation.html#cb23-15"></a><span class="co">## 4. Conclude:</span></span>
<span id="cb23-16"><a href="validation.html#cb23-16"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb23-17"><a href="validation.html#cb23-17"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb23-18"><a href="validation.html#cb23-18"></a>  <span class="cf">if</span> (lower.bound.criteria <span class="op">&amp;</span><span class="st"> </span>upper.bound.criteria) {</span>
<span id="cb23-19"><a href="validation.html#cb23-19"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb23-20"><a href="validation.html#cb23-20"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-21"><a href="validation.html#cb23-21"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb23-22"><a href="validation.html#cb23-22"></a>  },</span>
<span id="cb23-23"><a href="validation.html#cb23-23"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<p>Effectively, via the trial and error method we generate a sample with the same variance as the underlying truncated triangular distribution.</p>
<p>We may move on to test for the mean.</p>
</div>
<div id="hypothesis-test-for-mean" class="section level2">
<h2><span class="header-section-number">5.2</span> Hypothesis test for mean</h2>
<p>Specifically, when testing for mean equivalence using a t-test, we should validate that the sample mean follows a normal distribution. This does not mean that the data should be normally distributed.</p>
<p>This assumption, because of the central limit theorem, should hold up for fairly large datasets like ours. Roughly speaking, this can be assumed of any dataset with over 50 complete observations.</p>
<p>Let’s study the mathematical procedure.</p>
<p>We now want to validate that the mean of the sample is the same as that of the distribution (some value <span class="math inline">\(\mu\)</span>), we make opposing statements about it.</p>
<p><span class="math display">\[
  H_{0}:\hat{\mu} = \mu
\]</span></p>
<p><span class="math display">\[
  H_{a}:\hat{\mu} \neq \mu
\]</span></p>
<p>We then calculate the sample mean:</p>
<p><span class="math display">\[
  \bar{X}=\frac{\sum_{i=1}^{n}x_{i}}{n}
\]</span></p>
<p>and plug it into the test statistic:</p>
<p><span class="math display">\[
  \frac{\bar{X}-\mu}{\frac{S}{\sqrt{n}}} \sim t_{n-1}.
\]</span></p>
<p>The <em>alternate hypothesis</em> tells us that this is a two-tailed test, meaning we must use both ends of Student’s t distribution. We reject <span class="math inline">\(H_{0}\)</span> if the test statistic falls outside the interval bounded by the t inverse CDF evaluated at <span class="math inline">\(1-\frac{\alpha}{2}\)</span> and at <span class="math inline">\(\frac{\alpha}{2}\)</span> with <span class="math inline">\(n-1\)</span> degrees of freedom. This may seem unorthodox, but the most common notation used to reference these bounds is <span class="math inline">\(t_{1-\frac{\alpha}{2},n-1}\)</span> and <span class="math inline">\(t_{\frac{\alpha}{2},n-1}\)</span>.</p>
<p><span class="math display">\[
  t_{\frac{\alpha}{2},n-1}\leq\frac{\bar{X}-\mu}{\frac{S}{\sqrt{n}}}\leq t_{1-\frac{\alpha}{2},n-1} \Rightarrow \hat{\mu}=\mu
\]</span></p>
<p>We shall now implement this in R. Same as with the test for variance, there is no exact method to calculate the inverse CDF of Student’s t distribution that we could reasonably implement, and so we must use R’s native function to find approximate values.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="validation.html#cb25-1"></a><span class="co">## Inverse CDF method</span></span>
<span id="cb25-2"><a href="validation.html#cb25-2"></a></span>
<span id="cb25-3"><a href="validation.html#cb25-3"></a><span class="co">## 1. Sample mean and true mean</span></span>
<span id="cb25-4"><a href="validation.html#cb25-4"></a>x.bar.Inv.CDF &lt;-<span class="st"> </span><span class="kw">mean</span>(simulated.Z.prime.Inv.CDF)</span>
<span id="cb25-5"><a href="validation.html#cb25-5"></a></span>
<span id="cb25-6"><a href="validation.html#cb25-6"></a>mu &lt;-<span class="st"> </span>my.trun.tri.dist<span class="op">$</span>trun.tri.mean</span>
<span id="cb25-7"><a href="validation.html#cb25-7"></a></span>
<span id="cb25-8"><a href="validation.html#cb25-8"></a><span class="co">## 2. Test Statistic</span></span>
<span id="cb25-9"><a href="validation.html#cb25-9"></a>test.statistic &lt;-<span class="st"> </span>(x.bar.Inv.CDF <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(sigma.squared <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(simulated.Z.prime.Inv.CDF)))</span>
<span id="cb25-10"><a href="validation.html#cb25-10"></a></span>
<span id="cb25-11"><a href="validation.html#cb25-11"></a><span class="co">## 3. Evaluate if statistic falls within bounds</span></span>
<span id="cb25-12"><a href="validation.html#cb25-12"></a>lower.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb25-13"><a href="validation.html#cb25-13"></a>upper.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&lt;=</span><span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb25-14"><a href="validation.html#cb25-14"></a></span>
<span id="cb25-15"><a href="validation.html#cb25-15"></a><span class="co">## 4. Conclude:</span></span>
<span id="cb25-16"><a href="validation.html#cb25-16"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb25-17"><a href="validation.html#cb25-17"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb25-18"><a href="validation.html#cb25-18"></a>  <span class="cf">if</span> (lower.bound.criteria <span class="op">&amp;</span><span class="st"> </span>upper.bound.criteria) {</span>
<span id="cb25-19"><a href="validation.html#cb25-19"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb25-20"><a href="validation.html#cb25-20"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-21"><a href="validation.html#cb25-21"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb25-22"><a href="validation.html#cb25-22"></a>  },</span>
<span id="cb25-23"><a href="validation.html#cb25-23"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<p>Effectively, via the inverse CDF method we generate a sample with the same mean as the underlying truncated triangular distribution.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="validation.html#cb27-1"></a><span class="co">## Trial and Error</span></span>
<span id="cb27-2"><a href="validation.html#cb27-2"></a></span>
<span id="cb27-3"><a href="validation.html#cb27-3"></a><span class="co">## 1. Sample mean and true mean</span></span>
<span id="cb27-4"><a href="validation.html#cb27-4"></a>x.bar.t.and.e &lt;-<span class="st"> </span><span class="kw">mean</span>(simulated.Z.prime.t.and.e)</span>
<span id="cb27-5"><a href="validation.html#cb27-5"></a></span>
<span id="cb27-6"><a href="validation.html#cb27-6"></a>mu &lt;-<span class="st"> </span>my.trun.tri.dist<span class="op">$</span>trun.tri.mean</span>
<span id="cb27-7"><a href="validation.html#cb27-7"></a></span>
<span id="cb27-8"><a href="validation.html#cb27-8"></a><span class="co">## 2. Test Statistic</span></span>
<span id="cb27-9"><a href="validation.html#cb27-9"></a>test.statistic &lt;-<span class="st"> </span>(x.bar.t.and.e <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(sigma.squared <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(simulated.Z.prime.t.and.e)))</span>
<span id="cb27-10"><a href="validation.html#cb27-10"></a></span>
<span id="cb27-11"><a href="validation.html#cb27-11"></a><span class="co">## 3. Evaluate if statistic falls within bounds</span></span>
<span id="cb27-12"><a href="validation.html#cb27-12"></a>lower.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb27-13"><a href="validation.html#cb27-13"></a>upper.bound.criteria &lt;-<span class="st"> </span>test.statistic <span class="op">&lt;=</span><span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">df =</span> degrees.of.freedom)</span>
<span id="cb27-14"><a href="validation.html#cb27-14"></a></span>
<span id="cb27-15"><a href="validation.html#cb27-15"></a><span class="co">## 4. Conclude:</span></span>
<span id="cb27-16"><a href="validation.html#cb27-16"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb27-17"><a href="validation.html#cb27-17"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb27-18"><a href="validation.html#cb27-18"></a>  <span class="cf">if</span> (lower.bound.criteria <span class="op">&amp;</span><span class="st"> </span>upper.bound.criteria) {</span>
<span id="cb27-19"><a href="validation.html#cb27-19"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb27-20"><a href="validation.html#cb27-20"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-21"><a href="validation.html#cb27-21"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb27-22"><a href="validation.html#cb27-22"></a>  },</span>
<span id="cb27-23"><a href="validation.html#cb27-23"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<p>Effectively, via the trial and error method we generate a sample with the same mean as the underlying truncated triangular distribution.</p>
<p>We may move on to the goodness of fit tests.</p>
</div>
<div id="goodness-of-fit-tests" class="section level2">
<h2><span class="header-section-number">5.3</span> Goodness of Fit Tests</h2>
<p>Goodness of fit tests, for our purposes, serve as a means of validating paired statements about the distribution of our data. Specifically, our <em>null hypothesis</em> would state that the sampled random variable follows a PDF with its respective estimated parameters while our <em>alternate hypothesis</em> tells us exactly the opposite.</p>
<p>In terms of hypothesis:</p>
<p><span class="math display">\[
  H_{0}: \hat{f}(x) = f(x)
\]</span>
<span class="math display">\[
  H_{a}: \hat{f}(x) \neq f(x) \Leftrightarrow \neg H_{0}.
\]</span></p>
<p>Multiple tests have been devised for goodness of fit, each with their own strengths. It is up to us to determine the most sound method.</p>
<div id="chi-square-test" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Chi-Square Test</h3>
<p>The <span class="math inline">\(\chi^2\)</span> test is particularly useful when fitting data with a discrete distributions of moderate size, though the procedure can be extended to continuous distributions by <em>binning</em> the domain into intervals or classes of equal probability. For samples as large as ours this approach is perhaps not well suited since it is highly likely that the test will fail for most distributions since we require many bins to split the distribution and the probability of each becomes very narrow. Nonetheless, the procedure is enriching.</p>
<ol style="list-style-type: decimal">
<li>Estimate the parameters of the distributions you suspect the data shuld follow. We will use the parameters of the distribution we want the sample to resemble instead (Those of the truncated triangular distriburtion).</li>
</ol>
<blockquote>
<p>Let <span class="math inline">\(X \sim f(x)=Triangular(L,U,M)\)</span> and <span class="math inline">\(Z \sim h(x) = f(z| a &lt; X \leq b)\)</span></p>
</blockquote>
<p>where <span class="math inline">\(L = 2\)</span>, <span class="math inline">\(U = 9\)</span>, <span class="math inline">\(M = 7\)</span>, <span class="math inline">\(a = 3\)</span>, and <span class="math inline">\(b = 8\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Estimate the amount of classes or bins to categorize the continuous distribution. Often, for large datasets, it is recommended to pick <span class="math inline">\(\frac{\sqrt{n}}{5} \leq k \leq \sqrt{n}\)</span>.</li>
</ol>
<p><span class="math display">\[
  20 \leq k \leq 100.
\]</span></p>
<p>We will take <span class="math inline">\(k\)</span> to be 100.</p>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the probability that every class should have (<span class="math inline">\(p=1/k\)</span>) and find the bounds for each class with said probability.</li>
</ol>
<blockquote>
<p>Let H(x) be the CDF to the random variable Z.</p>
</blockquote>
<p>We define the lower and upper bounds of each class <span class="math inline">\(i\in \{ 1,\cdots, k\}\)</span> to be <span class="math inline">\(l_{i}\)</span> and <span class="math inline">\(u_{i}\)</span>. A value <span class="math inline">\(z\)</span> is said to belong to class <span class="math inline">\(i\)</span> if <span class="math inline">\(l_{i} \leq z &lt; u_{i}\)</span></p>
<p><span class="math display">\[
  l_{i} = H^{-1}(p(i-1)), \ u_{i} = H^{-1}(p*i)
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li><p>Once all classes have had their bounds calculated, we may count how many members of the random sample belong to each class (<span class="math inline">\(o_{i}\)</span>, observed frequency), and how many members we expected to beling according to its assigned probability (<span class="math inline">\(e_{i} = p*n\)</span>, expected frequency).</p></li>
<li><p>We ma now calculate the test statistic</p></li>
</ol>
<p><span class="math display">\[
  \sum_{i=1}^{k}\frac{(o_{i}-e_{i})^{2}}{e_{i}} \sim \chi^{2}_{k-r-1}
\]</span></p>
<p>Notice how the statistic follows a <span class="math inline">\(\chi^{2}\)</span> distribution with <span class="math inline">\(k-r-1\)</span> degrees of freedom. Where <span class="math inline">\(k\)</span> is the number of classes and <span class="math inline">\(r\)</span> is the amount of parameters of the distribution (5 for the truncated triangular).</p>
<ol start="6" style="list-style-type: decimal">
<li>Once again, consider you level of significance and evaluate the critical value after which the <em>null hypothesis</em> should be rejected. This is a right tail test.</li>
</ol>
<p><span class="math display">\[
  \sum_{i=1}^{k}\frac{(o_{i}-e_{i})^{2}}{e_{i}}\leq \chi^{2}_{1-\alpha,k-r-1} \Rightarrow \hat{h}(z)=h(z)
\]</span></p>
<p>Let’s see how we could go about doing this in R. First, for the inverse CDF method.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="validation.html#cb29-1"></a><span class="co">## Inverse CDF sample</span></span>
<span id="cb29-2"><a href="validation.html#cb29-2"></a></span>
<span id="cb29-3"><a href="validation.html#cb29-3"></a><span class="co">## Find the intervals for each class i in {1, ..., k}</span></span>
<span id="cb29-4"><a href="validation.html#cb29-4"></a>set.<span class="fl">1.</span>to.k &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span></span>
<span id="cb29-5"><a href="validation.html#cb29-5"></a>p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">100</span></span>
<span id="cb29-6"><a href="validation.html#cb29-6"></a>l_i &lt;-<span class="st"> </span><span class="kw">sapply</span>(p <span class="op">*</span><span class="st"> </span>(set.<span class="fl">1.</span>to.k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), my.trun.tri.dist<span class="op">$</span>inverse.cdf)</span>
<span id="cb29-7"><a href="validation.html#cb29-7"></a>u_i &lt;-<span class="st"> </span><span class="kw">sapply</span>(p <span class="op">*</span><span class="st"> </span>set.<span class="fl">1.</span>to.k, my.trun.tri.dist<span class="op">$</span>inverse.cdf)</span>
<span id="cb29-8"><a href="validation.html#cb29-8"></a></span>
<span id="cb29-9"><a href="validation.html#cb29-9"></a><span class="co">## Find the observed frequency of every class</span></span>
<span id="cb29-10"><a href="validation.html#cb29-10"></a>e_i &lt;-</span>
<span id="cb29-11"><a href="validation.html#cb29-11"></a><span class="st">  </span><span class="kw">sapply</span>(set.<span class="fl">1.</span>to.k, <span class="cf">function</span>(i) {</span>
<span id="cb29-12"><a href="validation.html#cb29-12"></a>    <span class="kw">sum</span>(simulated.Z.prime.Inv.CDF <span class="op">&gt;=</span><span class="st"> </span>l_i[i]</span>
<span id="cb29-13"><a href="validation.html#cb29-13"></a>      <span class="op">&amp;</span><span class="st"> </span>simulated.Z.prime.Inv.CDF <span class="op">&lt;=</span><span class="st"> </span>u_i[i]</span>
<span id="cb29-14"><a href="validation.html#cb29-14"></a>    )</span>
<span id="cb29-15"><a href="validation.html#cb29-15"></a>  })</span>
<span id="cb29-16"><a href="validation.html#cb29-16"></a></span>
<span id="cb29-17"><a href="validation.html#cb29-17"></a><span class="co">## Find the expected frequency</span></span>
<span id="cb29-18"><a href="validation.html#cb29-18"></a>o_i &lt;-<span class="st"> </span>p <span class="op">*</span><span class="st"> </span><span class="dv">10000</span></span>
<span id="cb29-19"><a href="validation.html#cb29-19"></a></span>
<span id="cb29-20"><a href="validation.html#cb29-20"></a><span class="co">## Calculate the test statistic</span></span>
<span id="cb29-21"><a href="validation.html#cb29-21"></a>test.statistic &lt;-<span class="st"> </span><span class="kw">sum</span>(((o_i <span class="op">-</span><span class="st"> </span>e_i) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>e_i)</span>
<span id="cb29-22"><a href="validation.html#cb29-22"></a></span>
<span id="cb29-23"><a href="validation.html#cb29-23"></a><span class="co">## Calculate the Chi Square ritical value</span></span>
<span id="cb29-24"><a href="validation.html#cb29-24"></a>critical.value &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df =</span> <span class="dv">100</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb29-25"><a href="validation.html#cb29-25"></a></span>
<span id="cb29-26"><a href="validation.html#cb29-26"></a><span class="co">## Conclude</span></span>
<span id="cb29-27"><a href="validation.html#cb29-27"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb29-28"><a href="validation.html#cb29-28"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb29-29"><a href="validation.html#cb29-29"></a>  <span class="cf">if</span> (test.statistic <span class="op">&lt;=</span><span class="st"> </span>critical.value) {</span>
<span id="cb29-30"><a href="validation.html#cb29-30"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb29-31"><a href="validation.html#cb29-31"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-32"><a href="validation.html#cb29-32"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb29-33"><a href="validation.html#cb29-33"></a>  },</span>
<span id="cb29-34"><a href="validation.html#cb29-34"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="validation.html#cb31-1"></a><span class="co">## Trial and Error</span></span>
<span id="cb31-2"><a href="validation.html#cb31-2"></a></span>
<span id="cb31-3"><a href="validation.html#cb31-3"></a><span class="co">## Find the observed frequency of every class</span></span>
<span id="cb31-4"><a href="validation.html#cb31-4"></a>e_i &lt;-</span>
<span id="cb31-5"><a href="validation.html#cb31-5"></a><span class="st">  </span><span class="kw">sapply</span>(set.<span class="fl">1.</span>to.k, <span class="cf">function</span>(i) {</span>
<span id="cb31-6"><a href="validation.html#cb31-6"></a>    <span class="kw">sum</span>(simulated.Z.prime.t.and.e <span class="op">&gt;=</span><span class="st"> </span>l_i[i]</span>
<span id="cb31-7"><a href="validation.html#cb31-7"></a>      <span class="op">&amp;</span><span class="st"> </span>simulated.Z.prime.t.and.e <span class="op">&lt;=</span><span class="st"> </span>u_i[i]</span>
<span id="cb31-8"><a href="validation.html#cb31-8"></a>    )</span>
<span id="cb31-9"><a href="validation.html#cb31-9"></a>  })</span>
<span id="cb31-10"><a href="validation.html#cb31-10"></a></span>
<span id="cb31-11"><a href="validation.html#cb31-11"></a><span class="co">## Calculate the test statistic</span></span>
<span id="cb31-12"><a href="validation.html#cb31-12"></a>test.statistic &lt;-<span class="st"> </span><span class="kw">sum</span>(((o_i <span class="op">-</span><span class="st"> </span>e_i) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>e_i)</span>
<span id="cb31-13"><a href="validation.html#cb31-13"></a></span>
<span id="cb31-14"><a href="validation.html#cb31-14"></a><span class="co">## Conclude</span></span>
<span id="cb31-15"><a href="validation.html#cb31-15"></a><span class="kw">print</span>(<span class="kw">paste</span>(</span>
<span id="cb31-16"><a href="validation.html#cb31-16"></a>  <span class="st">&quot;With a significance level of 0.1, we &quot;</span>,</span>
<span id="cb31-17"><a href="validation.html#cb31-17"></a>  <span class="cf">if</span> (test.statistic <span class="op">&lt;=</span><span class="st"> </span>critical.value) {</span>
<span id="cb31-18"><a href="validation.html#cb31-18"></a>    <span class="st">&quot;may not reject the null hypothesis&quot;</span></span>
<span id="cb31-19"><a href="validation.html#cb31-19"></a>  } <span class="cf">else</span> {</span>
<span id="cb31-20"><a href="validation.html#cb31-20"></a>    <span class="st">&quot;may reject the null hypothesis&quot;</span></span>
<span id="cb31-21"><a href="validation.html#cb31-21"></a>  },</span>
<span id="cb31-22"><a href="validation.html#cb31-22"></a>  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;With a significance level of 0.1, we may not reject the null hypothesis&quot;</code></pre>
<p>Effectively, it would seem that both our procedures for generating a sample from the truncated triangular distribution were succesful. Let us move on to a more well suited test for our scenario.</p>
</div>
<div id="kolmogorov-smirnov-test" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Kolmogorov-Smirnov Test</h3>
<p>The Komogorov-Smirnov test is more robust for goodness of fit procedures than the <span class="math inline">\(\chi^{2}\)</span> because it allows for samples of any size and it does not require that you split continuous functions into bins or classes, which is undesirable as it introduces a source of error.</p>
<p>The procedure goes as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Order the random sample from smalles to largest, without removing duplcates (yields <span class="math inline">\(y_{j}, \forall j\in \{1,\cdots, n \}\)</span>).</p></li>
<li><p>Calculate the test statistic as follows:</p></li>
</ol>
<p><span class="math display">\[
  D^{+} = \max_{y_{j}, \forall j\in \{1,\cdots, n\}}{\{ j/n - H(y_{j})\}},\ D^{-} = \max_{y_{j}, \forall j\in \{1,\cdots, n\}}{\{ H(y_{j}) - (j-1)/n\}}
\]</span></p>
<p><span class="math display">\[
  D = \max{\{ D^{+}, D^{-}\}}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>If <span class="math inline">\(D\)</span> is greater than the K-S critical value for <span class="math inline">\(\alpha = 0.1\)</span> and <span class="math inline">\(n=10,000\)</span>, reject the <em>null hypothesis</em>.</li>
</ol>
<p>The procedure seems fairly straight forward, except for the part where we calculate the K-S critical value. This time, at least in R, you might require some outside resources such as a K-S table or a library that can simulate the statistic with which to compare. We will not implement this procedure in R since we already have evidence that the samples follow the truncated triangular distribution described in previous chapters.</p>
</div>
</div>
<div id="further-analysis" class="section level2">
<h2><span class="header-section-number">5.4</span> Further Analysis</h2>
<p>Keep in mind that these tests all have their respective counterparts wherin a comparison is made not between a dataset and a distribution but between datasets, meaning we could also ask ourselves whether or not both methods for simulating a probability density function produce similar samples in terms of variance, mean, and goodness of fit.</p>
<p>Notice also that we could have used a much more restrictive level of significance. In fact, the smallest p-value among all tests could yield us an <span class="math inline">\(\alpha\)</span> for which all tests would still pass and make our reasearch mush more significant, but such is considered a bad practice. Remember the term <em>p-hacking</em> for future reference and frown upon anyone who abuses statistics in this fashion.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulation.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
