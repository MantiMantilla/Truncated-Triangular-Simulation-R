<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Simulation | Simulating the Truncated Triangular Distribution</title>
  <meta name="description" content="THis documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Simulation | Simulating the Truncated Triangular Distribution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="THis documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  <meta name="github-repo" content="MantiMantilla/Truncated-Triangular-Simulation-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Simulation | Simulating the Truncated Triangular Distribution" />
  
  <meta name="twitter:description" content="THis documentation pertains to the implementation of a Monte Carlo simulation script written in base R." />
  

<meta name="author" content="Alejandro Mantilla" />


<meta name="date" content="2021-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="truncated-triangular-distribution.html"/>
<link rel="next" href="validation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#your-own-flare"><i class="fa fa-check"></i><b>1.2</b> Your own flare</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#project-home"><i class="fa fa-check"></i><b>1.3</b> Project home</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.4</b> Disclaimer</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.5</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#author"><i class="fa fa-check"></i><b>1.6</b> Author</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.7</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="triangular-distribution.html"><a href="triangular-distribution.html"><i class="fa fa-check"></i><b>2</b> Triangular Distribution</a><ul>
<li class="chapter" data-level="2.1" data-path="triangular-distribution.html"><a href="triangular-distribution.html#distributions"><i class="fa fa-check"></i><b>2.1</b> Distributions</a></li>
<li class="chapter" data-level="2.2" data-path="triangular-distribution.html"><a href="triangular-distribution.html#triangular-pdf"><i class="fa fa-check"></i><b>2.2</b> Triangular PDF</a></li>
<li class="chapter" data-level="2.3" data-path="triangular-distribution.html"><a href="triangular-distribution.html#triangular-cdf"><i class="fa fa-check"></i><b>2.3</b> Triangular CDF</a></li>
<li class="chapter" data-level="2.4" data-path="triangular-distribution.html"><a href="triangular-distribution.html#inverse-triangular-cdf"><i class="fa fa-check"></i><b>2.4</b> Inverse Triangular CDF</a></li>
<li class="chapter" data-level="2.5" data-path="triangular-distribution.html"><a href="triangular-distribution.html#measures-of-central-tendency-and-spread"><i class="fa fa-check"></i><b>2.5</b> Measures of Central Tendency and Spread</a><ul>
<li class="chapter" data-level="2.5.1" data-path="triangular-distribution.html"><a href="triangular-distribution.html#mean"><i class="fa fa-check"></i><b>2.5.1</b> Mean</a></li>
<li class="chapter" data-level="2.5.2" data-path="triangular-distribution.html"><a href="triangular-distribution.html#median"><i class="fa fa-check"></i><b>2.5.2</b> Median</a></li>
<li class="chapter" data-level="2.5.3" data-path="triangular-distribution.html"><a href="triangular-distribution.html#mode"><i class="fa fa-check"></i><b>2.5.3</b> Mode</a></li>
<li class="chapter" data-level="2.5.4" data-path="triangular-distribution.html"><a href="triangular-distribution.html#variance"><i class="fa fa-check"></i><b>2.5.4</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="triangular-distribution.html"><a href="triangular-distribution.html#an-object-to-hold-these-properties"><i class="fa fa-check"></i><b>2.6</b> An Object to Hold These Properties</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html"><i class="fa fa-check"></i><b>3</b> Truncated Triangular Distribution</a><ul>
<li class="chapter" data-level="3.1" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-distribution"><i class="fa fa-check"></i><b>3.1</b> Truncated Distribution</a></li>
<li class="chapter" data-level="3.2" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-triangular-pdf"><i class="fa fa-check"></i><b>3.2</b> Truncated Triangular PDF</a></li>
<li class="chapter" data-level="3.3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#truncated-triangular-cdf"><i class="fa fa-check"></i><b>3.3</b> Truncated Triangular CDF</a></li>
<li class="chapter" data-level="3.4" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#inverse-truncated-triangular-cdf"><i class="fa fa-check"></i><b>3.4</b> Inverse Truncated Triangular CDF</a></li>
<li class="chapter" data-level="3.5" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#measures-of-central-tendency-and-spread-1"><i class="fa fa-check"></i><b>3.5</b> Measures of Central Tendency and Spread</a><ul>
<li class="chapter" data-level="3.5.1" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#mean-1"><i class="fa fa-check"></i><b>3.5.1</b> Mean</a></li>
<li class="chapter" data-level="3.5.2" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#median-1"><i class="fa fa-check"></i><b>3.5.2</b> Median</a></li>
<li class="chapter" data-level="3.5.3" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#mode-1"><i class="fa fa-check"></i><b>3.5.3</b> Mode</a></li>
<li class="chapter" data-level="3.5.4" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#variance-1"><i class="fa fa-check"></i><b>3.5.4</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="truncated-triangular-distribution.html"><a href="truncated-triangular-distribution.html#an-object-to-hold-these-properties-1"><i class="fa fa-check"></i><b>3.6</b> An Object to Hold These Properties</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>4</b> Simulation</a><ul>
<li class="chapter" data-level="4.1" data-path="simulation.html"><a href="simulation.html#uniform-distribution"><i class="fa fa-check"></i><b>4.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="4.2" data-path="simulation.html"><a href="simulation.html#pseudo-random-uniform-numbers"><i class="fa fa-check"></i><b>4.2</b> Pseudo-random Uniform Numbers</a></li>
<li class="chapter" data-level="4.3" data-path="simulation.html"><a href="simulation.html#pseudo-random-variables"><i class="fa fa-check"></i><b>4.3</b> Pseudo-Random Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="simulation.html"><a href="simulation.html#inverse-cdf-method"><i class="fa fa-check"></i><b>4.3.1</b> Inverse CDF Method</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulation.html"><a href="simulation.html#trial-and-error"><i class="fa fa-check"></i><b>4.3.2</b> Trial and Error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>5</b> Validation</a><ul>
<li class="chapter" data-level="5.1" data-path="validation.html"><a href="validation.html#hypothesis-test-for-variance"><i class="fa fa-check"></i><b>5.1</b> Hypothesis test for Variance</a></li>
<li class="chapter" data-level="5.2" data-path="validation.html"><a href="validation.html#hypothesis-test-for-mean"><i class="fa fa-check"></i><b>5.2</b> Hypothesis test for mean</a></li>
<li class="chapter" data-level="5.3" data-path="validation.html"><a href="validation.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>5.3</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="5.4" data-path="validation.html"><a href="validation.html#chi-square-test"><i class="fa fa-check"></i><b>5.4</b> Chi-Square Test</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulating the Truncated Triangular Distribution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1">
<h1><span class="header-section-number">4</span> Simulation</h1>
<p>So far we have designed two constructor functions, <code>generate.triangular()</code> and <code>generate.truncated.triangular()</code>, with which we may create triangular distributions and truncated triangular distributions respectively. Let’s move one to some code the actually does something. Say, for example, that the truncated triangular distribution is how you chose for a random variable to behave, how long it takes for a crop to grow or the amount of rain water of a particular time period. Being able to randomly sample instances of this variable without having to wait for rainfall or for crops to grow and study how a larger system behaves as a function of this random variable could be highly beneficial and is, in fact, the basis of Monte Carlo simulation.</p>
<p>Some definitions for this section:</p>
<blockquote>
<p>Let <span class="math inline">\(Z \sim f(x) = Triangular(2, 9, 7)\)</span> and <span class="math inline">\(Z&#39; \sim f(x|3 &lt; X \leq 8)=h(x)\)</span></p>
</blockquote>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simulation.html#cb16-1"></a><span class="co">## Set a seed so results are replicable</span></span>
<span id="cb16-2"><a href="simulation.html#cb16-2"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb16-3"><a href="simulation.html#cb16-3"></a></span>
<span id="cb16-4"><a href="simulation.html#cb16-4"></a><span class="co">## Create a list that contains the major properties of a triangular</span></span>
<span id="cb16-5"><a href="simulation.html#cb16-5"></a><span class="co">## distribution with L = 2, U = 9, and M = 7</span></span>
<span id="cb16-6"><a href="simulation.html#cb16-6"></a>my.tri.dist &lt;-<span class="st"> </span><span class="kw">generate.triangular</span>(<span class="dt">L =</span> <span class="dv">2</span>, <span class="dt">U =</span> <span class="dv">9</span>, <span class="dt">M =</span> <span class="dv">7</span>)</span>
<span id="cb16-7"><a href="simulation.html#cb16-7"></a></span>
<span id="cb16-8"><a href="simulation.html#cb16-8"></a><span class="co">## Create a list that contains the major properties of a truncated</span></span>
<span id="cb16-9"><a href="simulation.html#cb16-9"></a><span class="co">## triangular distribution between a = 3 and b = 8, based on the</span></span>
<span id="cb16-10"><a href="simulation.html#cb16-10"></a><span class="co">## previous triangular</span></span>
<span id="cb16-11"><a href="simulation.html#cb16-11"></a>my.trun.tri.dist &lt;-</span>
<span id="cb16-12"><a href="simulation.html#cb16-12"></a><span class="st">  </span><span class="kw">generate.truncated.triangular</span>(<span class="dt">a =</span> <span class="dv">3</span>,</span>
<span id="cb16-13"><a href="simulation.html#cb16-13"></a>                                <span class="dt">b =</span> <span class="dv">8</span>,</span>
<span id="cb16-14"><a href="simulation.html#cb16-14"></a>                                <span class="dt">orig.tri.dist =</span> my.tri.dist)</span></code></pre></div>
<div id="uniform-distribution" class="section level2">
<h2><span class="header-section-number">4.1</span> Uniform Distribution</h2>
<p>This may well be the most simple continuous probability density function. The uniform distribution, describes a random variable that is equiprobable at all values within an interval. This means that given an interval <span class="math inline">\([a,b]\)</span>, a random variable <span class="math inline">\(X\)</span> can be any value greater than or equal to <span class="math inline">\(a\)</span> and smaller than or equal to <span class="math inline">\(b\)</span> with the same likelihood. Let’s express this mathematically!</p>
<blockquote>
<p>Let <span class="math inline">\(U \sim g(x)=Uniform(a,b)\)</span>, where</p>
</blockquote>
<p><span class="math display">\[
  g(x) =
  \begin{cases}
    \frac{1}{b-a} \quad&amp; (a\leq x\leq b)\\
    0 \quad&amp; (x\notin [a,b])
  \end{cases}
\]</span>
No need to implement this programatically, it is a very simple distribution that we use inderectly when generating random numbers.</p>
</div>
<div id="pseudo-random-uniform-numbers" class="section level2">
<h2><span class="header-section-number">4.2</span> Pseudo-random Uniform Numbers</h2>
<p>We’ll concern ourselves with a method to simulate a uniform random variable, the <em>linear congruence method</em>. This is useful to generate numbers that follow a uniform distribution which we can then transform into any distribution. Know that it is not the most widespread method, but the most simple which will result in a reliable random rumber generator. Most software will use some implementation of the <em>Mersenne Twister</em> if you’re looking for further reading.</p>
<p>It is not possible to produce a sequence of numbers that is truly random. If you knew the initial conditions of a system, with enough information you could perfectly predict it. Rather, pseudo-random number generators (RNGs) take some <em>seed</em> (<span class="math inline">\(X_{0}\)</span>) as its initial state and produces numbers from it following a deterministic procedure that is too difficult to reverse without knowing the seed. The seed is properly hidden from the target of the random numbers and so the system seems random, since they have no way to predict what the next condition will be. All following numbers are indexed as <span class="math inline">\(X_{1},X_{2},\cdots,X_{n}\)</span>. The general expression for the sequence is as follows:</p>
<p><span class="math display">\[
  X_{n+1} = (aX_{n}+c) \mod m.
\]</span></p>
<p>Where <span class="math inline">\(m\)</span> is usually a prime number, <span class="math inline">\(a\)</span> is some positive integer smaller than <span class="math inline">\(m\)</span>, and c is some integer in the interval <span class="math inline">\([0,m[\)</span>.</p>
<p>The numbers in this sequence are not samples of a uniform random variable. The actual sequence of uniformly distributed random numbers, <span class="math inline">\(U_{n}\)</span>, is the following transform of the <span class="math inline">\(X_{n}\)</span> sequence.</p>
<p><span class="math display">\[
  U_{n}=\frac{X_{n}}{m}
\]</span></p>
<p><span class="math inline">\(U_{n}\)</span> is a sequence of uniformly distributed numbers on the interval <span class="math inline">\([0,1[\)</span>. If we wanted another sequence of random numbers, <span class="math inline">\(U&#39;_{n}\)</span> on some other interval, <span class="math inline">\([a,b[\)</span>, we would do the following transform.</p>
<p><span class="math display">\[
  U&#39;_{n}=U_{n} (b - a) + a
\]</span></p>
<p>Notice how when <span class="math inline">\(U_{n}\)</span> is very close to <span class="math inline">\(1\)</span>, <span class="math inline">\(U&#39;_{n}\)</span> comes very close to being <span class="math inline">\(b\)</span>, whereas when <span class="math inline">\(U_{n}\)</span> is <span class="math inline">\(0\)</span>, <span class="math inline">\(U&#39;_{n}\)</span> is just <span class="math inline">\(a\)</span>, and so we now have a random sample of numbers uniformly distributed on the interval <span class="math inline">\([a,b[\)</span>.</p>
<p>We also won’t implement this procedure since most programming languages already have a function to produce uniformly distributed numbers on the interval <span class="math inline">\([0,1[\)</span>, though knowing how one may do so will come in handy. In R, this function is <code>runif()</code>.</p>
<p>One last thing to note is that one should never return <span class="math inline">\(U_{0}\)</span> or <span class="math inline">\(U&#39;_{0}\)</span> as a random number, since a user with malicious intent could easily derive the seed from it.</p>
</div>
<div id="pseudo-random-variables" class="section level2">
<h2><span class="header-section-number">4.3</span> Pseudo-Random Variables</h2>
<p>Let us now consider two methods for generating samples of variables following arbitrary distributions off of a sequence of uniformly distributed random numbers, <span class="math inline">\(U_{n}\)</span>.</p>
<div id="inverse-cdf-method" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Inverse CDF Method</h3>
<p>You may have noticed already when studying the triangular CDF, but given a random variable <span class="math inline">\(Y\)</span> with PDF <span class="math inline">\(f(y)\)</span> and CDF <span class="math inline">\(F(y)\)</span>, the CDF produces a value on the interval <span class="math inline">\([0,1]\)</span>. The inverse CDF will also take a value on the interval <span class="math inline">\([0,1]\)</span> and assign it a <span class="math inline">\(y\)</span>.</p>
<p>Mathematicaly,</p>
<p><span class="math display">\[
  F(y) = p \Rightarrow F^{-1}\left(F\left(y\right)\right)=F^{-1}\left(p\right) \Rightarrow y = F^{-1}\left(p\right).
\]</span></p>
<p>This means that given some value between 0 and 1, we can apply the inverse CDF to it and get a matching value, <span class="math inline">\(y\)</span>. If we do this to all elements in a random sample of values between 0 and 1 we can get a random sample of <span class="math inline">\(y\)</span>s that follow the PDF <span class="math inline">\(f(y)\)</span>. Let’s see this implemented in R</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simulation.html#cb17-1"></a><span class="co">## 1. Generate a sequence of uniform random numbers on the interval [0, 1].</span></span>
<span id="cb17-2"><a href="simulation.html#cb17-2"></a><span class="co">## 10000 should be enough.</span></span>
<span id="cb17-3"><a href="simulation.html#cb17-3"></a>U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">10000</span>)</span>
<span id="cb17-4"><a href="simulation.html#cb17-4"></a></span>
<span id="cb17-5"><a href="simulation.html#cb17-5"></a><span class="co">## 2. Transform all elements of the U sequence with the inverse CDF</span></span>
<span id="cb17-6"><a href="simulation.html#cb17-6"></a><span class="co">## of the truncated distribution</span></span>
<span id="cb17-7"><a href="simulation.html#cb17-7"></a>simulated.Z.prime.Inv.CDF &lt;-<span class="st"> </span><span class="kw">sapply</span>(U, my.trun.tri.dist<span class="op">$</span>inverse.cdf)</span></code></pre></div>
<p>The variable <code>simulated.Z.prime</code> holds a sequence of numbers that follow the truncated triangular distribution defined at the start of this section. Let’s plot a histogram of this sequence along with the curve of the pdf it should ressemble.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simulation.html#cb18-1"></a><span class="co">## Plot and describe the first simulation with many bins</span></span>
<span id="cb18-2"><a href="simulation.html#cb18-2"></a><span class="kw">hist</span>(simulated.Z.prime.Inv.CDF,</span>
<span id="cb18-3"><a href="simulation.html#cb18-3"></a>     <span class="dt">xlab =</span> <span class="st">&quot;z&quot;</span>,</span>
<span id="cb18-4"><a href="simulation.html#cb18-4"></a>     <span class="dt">breaks =</span> (my.trun.tri.dist<span class="op">$</span>trun.tri.upper <span class="op">-</span><span class="st"> </span>my.trun.tri.dist<span class="op">$</span>trun.tri.lower) <span class="op">*</span><span class="st"> </span><span class="dv">10</span>,</span>
<span id="cb18-5"><a href="simulation.html#cb18-5"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb18-6"><a href="simulation.html#cb18-6"></a></span>
<span id="cb18-7"><a href="simulation.html#cb18-7"></a><span class="kw">plot.function</span>(</span>
<span id="cb18-8"><a href="simulation.html#cb18-8"></a>  <span class="cf">function</span>(z) {<span class="kw">sapply</span>(z, my.trun.tri.dist<span class="op">$</span>pdf)},</span>
<span id="cb18-9"><a href="simulation.html#cb18-9"></a>  <span class="dt">from =</span> <span class="fl">2.99999</span>,</span>
<span id="cb18-10"><a href="simulation.html#cb18-10"></a>  <span class="dt">to =</span> <span class="fl">8.0001</span>,</span>
<span id="cb18-11"><a href="simulation.html#cb18-11"></a>  <span class="dt">n =</span> <span class="dv">100000</span>,</span>
<span id="cb18-12"><a href="simulation.html#cb18-12"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb18-13"><a href="simulation.html#cb18-13"></a>  <span class="dt">add =</span> <span class="ot">TRUE</span></span>
<span id="cb18-14"><a href="simulation.html#cb18-14"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Plot%20Simulated%20Inverse%20CDF-1.png" width="672" /></p>
<p>The truncated triangular PDF seems to closely fit the random sample. This is a good sign that our procedure is correct but is not enough to say for sure.</p>
</div>
<div id="trial-and-error" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Trial and Error</h3>
<p>An expression for the inverse CDF of a distribution is not always easy or possible to derive. If such is the case, we execute the following procedure. One weakness of this approach is it only works for random variables on a closed, finite interval, meaning that the likes of the normal and exponential distributions can’t be simulated reliably. Also, this is a slower approach because we can’t know how long it will take until we’ve sampled enough numbers from the distribution. Luckily, the truncated distribution requires that we simulate within an interval and the expected value of iterations until we reach the desired sample size is its minimum the way it is implemented in our code.</p>
<ol style="list-style-type: decimal">
<li><p>Find a constant function that is always greater than the PDF you are trying to simulate. The closer this constant is to being the max of the PDF the better.</p></li>
<li><p>Take a uniform random number and transform it on the interval of the domain of your PDF.</p></li>
<li><p>Take the next random uniform number, and transform it so it falls between 0 and the constant you found on step one.</p></li>
<li><p>Evaluate if the transformed value in step three is less than or equal to the PDF evaluated on the transformed value from step two.</p></li>
<li><p>If the condition in step four is met, add the transformed value from step 2 to your sample of the PDF.</p></li>
<li><p>Repeat steps two through five until you have gathered your goal sample size.</p></li>
</ol>
<p>Let’s see this procedure implemented programatically.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simulation.html#cb19-1"></a><span class="co">## Simulate 10000 instances of a random variable with f(x) = truncated triangular by trial and error.</span></span>
<span id="cb19-2"><a href="simulation.html#cb19-2"></a>simulated.Z.prime.t.and.e &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb19-3"><a href="simulation.html#cb19-3"></a>success.count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb19-4"><a href="simulation.html#cb19-4"></a><span class="co">## Stop once we&#39;ve achieved 10000 succesful numbers</span></span>
<span id="cb19-5"><a href="simulation.html#cb19-5"></a><span class="cf">while</span> (success.count <span class="op">&lt;</span><span class="st"> </span><span class="dv">10000</span>) {</span>
<span id="cb19-6"><a href="simulation.html#cb19-6"></a>  <span class="co">## Step 2</span></span>
<span id="cb19-7"><a href="simulation.html#cb19-7"></a>  u<span class="fl">.1</span> &lt;-</span>
<span id="cb19-8"><a href="simulation.html#cb19-8"></a><span class="st">    </span><span class="kw">runif</span>(</span>
<span id="cb19-9"><a href="simulation.html#cb19-9"></a>      <span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb19-10"><a href="simulation.html#cb19-10"></a>      <span class="dt">min =</span> my.trun.tri.dist<span class="op">$</span>trun.tri.lower,</span>
<span id="cb19-11"><a href="simulation.html#cb19-11"></a>      <span class="dt">max =</span> my.trun.tri.dist<span class="op">$</span>trun.tri.upper</span>
<span id="cb19-12"><a href="simulation.html#cb19-12"></a>    )</span>
<span id="cb19-13"><a href="simulation.html#cb19-13"></a>  <span class="co">## Step 3</span></span>
<span id="cb19-14"><a href="simulation.html#cb19-14"></a>  u<span class="fl">.2</span> &lt;-</span>
<span id="cb19-15"><a href="simulation.html#cb19-15"></a><span class="st">    </span><span class="kw">runif</span>(</span>
<span id="cb19-16"><a href="simulation.html#cb19-16"></a>      <span class="dt">n =</span> <span class="dv">1</span>,</span>
<span id="cb19-17"><a href="simulation.html#cb19-17"></a>      <span class="dt">min =</span> <span class="dv">0</span>,</span>
<span id="cb19-18"><a href="simulation.html#cb19-18"></a>      <span class="dt">max =</span> my.trun.tri.dist<span class="op">$</span><span class="kw">pdf</span>(my.trun.tri.dist<span class="op">$</span>trun.tri.mode)</span>
<span id="cb19-19"><a href="simulation.html#cb19-19"></a>    )</span>
<span id="cb19-20"><a href="simulation.html#cb19-20"></a>  <span class="co">## Step 4</span></span>
<span id="cb19-21"><a href="simulation.html#cb19-21"></a>  <span class="cf">if</span> (u<span class="fl">.2</span> <span class="op">&lt;=</span><span class="st"> </span>my.trun.tri.dist<span class="op">$</span><span class="kw">pdf</span>(u<span class="fl">.1</span>)) {</span>
<span id="cb19-22"><a href="simulation.html#cb19-22"></a>    <span class="co"># Step 5</span></span>
<span id="cb19-23"><a href="simulation.html#cb19-23"></a>    success.count &lt;-<span class="st"> </span>success.count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb19-24"><a href="simulation.html#cb19-24"></a>    simulated.Z.prime.t.and.e[success.count] &lt;-<span class="st"> </span>u<span class="fl">.1</span></span>
<span id="cb19-25"><a href="simulation.html#cb19-25"></a>  }</span>
<span id="cb19-26"><a href="simulation.html#cb19-26"></a>}</span></code></pre></div>
<p>In the case of the truncated triangular PDF we know it reaches its maximum when evaluated on its mode, meaning we can take the value <span class="math inline">\(h(mode)\)</span> as the constant of step 1.</p>
<p>Again, let’s plot these results to see how we did.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="simulation.html#cb20-1"></a><span class="co">## Plot and describe the first simulation with many bins</span></span>
<span id="cb20-2"><a href="simulation.html#cb20-2"></a><span class="kw">hist</span>(simulated.Z.prime.t.and.e,</span>
<span id="cb20-3"><a href="simulation.html#cb20-3"></a>     <span class="dt">xlab =</span> <span class="st">&quot;z&quot;</span>,</span>
<span id="cb20-4"><a href="simulation.html#cb20-4"></a>     <span class="dt">breaks =</span> (my.trun.tri.dist<span class="op">$</span>trun.tri.upper <span class="op">-</span><span class="st"> </span>my.trun.tri.dist<span class="op">$</span>trun.tri.lower) <span class="op">*</span><span class="st"> </span><span class="dv">10</span>,</span>
<span id="cb20-5"><a href="simulation.html#cb20-5"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span>
<span id="cb20-6"><a href="simulation.html#cb20-6"></a></span>
<span id="cb20-7"><a href="simulation.html#cb20-7"></a><span class="kw">plot.function</span>(</span>
<span id="cb20-8"><a href="simulation.html#cb20-8"></a>  <span class="cf">function</span>(z) {<span class="kw">sapply</span>(z, my.trun.tri.dist<span class="op">$</span>pdf)},</span>
<span id="cb20-9"><a href="simulation.html#cb20-9"></a>  <span class="dt">from =</span> <span class="fl">2.99999</span>,</span>
<span id="cb20-10"><a href="simulation.html#cb20-10"></a>  <span class="dt">to =</span> <span class="fl">8.0001</span>,</span>
<span id="cb20-11"><a href="simulation.html#cb20-11"></a>  <span class="dt">n =</span> <span class="dv">100000</span>,</span>
<span id="cb20-12"><a href="simulation.html#cb20-12"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb20-13"><a href="simulation.html#cb20-13"></a>  <span class="dt">add =</span> <span class="ot">TRUE</span></span>
<span id="cb20-14"><a href="simulation.html#cb20-14"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Plot%20Simulated%20Trial%20and%20Error-1.png" width="672" /></p>
<p>Once again, the distribution closely ressembles the sampled data. Next, we will look into testing the hypothesis that the sample matches the distribution.</p>
<p>Whichever method is fine for simulating or sampling PDFs, but know that each has its benefits. You would use the inverse CDF ideally on all scenarios as it is easy to implement, given an inverse CDF, but if such is not available to you or there is no interest in deriving one, the slower simulation by trial and error would still prove reliable.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="truncated-triangular-distribution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="validation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
